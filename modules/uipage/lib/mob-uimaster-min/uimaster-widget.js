function checkUIMasterReady(){return true}function g(b,a){return UIMaster.browser.mozilla?b.getAttribute(a):$(b).attr(a)}UIMaster.ui=function(a){a=a||{};UIMaster.apply(this,a);UIMaster.apply(this.ui,this,true);return this.ui};UIMaster.ui=UIMaster.extend(UIMaster.ui,{ui:null,initialized:false,setVisible:function(a){a?$(this.parentDiv).show():$(this.parentDiv).hide()},setEnabled:function(a){this.disabled=!a;this.parentDiv&&(this.parentDiv.disabled=!a);if(a){this.grayWidgetLabelStyle(this.name,false)}else{this.grayWidgetLabelStyle(this.name,true)}},setLabelText:function(a){var b=this.previousSibling?(this.previousSibling.nodeType==1?this.previousSibling:this.previousSibling.previousSibling):null;b?b.childNodes[0].nodeValue=a:$(this).before($("<label></label>").attr({id:this.name+"_widgetLabel","for":this.name}).addClass("uimaster_widgetLabel").css("display","block").text(a))},addListener:function(b,a){$(this).bind(b,a)},removeListener:function(b,a){$(this).unbind(b,a)},init:function(){this.parentDiv=this.parentNode},grayWidgetLabelStyle:function(c,a){var d=document.getElementById(c)||document.getElementsByName(c)[0];if(d){var b=RESOURCE_CONTEXTPATH+USER_CONSTRAINT_IMG;if(a){b=b.substring(0,b.indexOf("."))+"_gray.gif";$(d).parent().find("label[class*=uimaster_widgetLabel]").addClass("uimaster_widgetLabel_gray").end().find('img[src$="uimaster_constraint.gif"]').attr("src",b)}else{$(d).parent().find("label[class*=uimaster_widgetLabel]").removeClass("uimaster_widgetLabel_gray").end().find('img[src$="uimaster_constraint_gray.gif"]').attr("src",b)}}},addAttr:function(b){$(this).attr(b.name,b.value)},removeAttr:function(a){$(this).removeAttr(a)}});UIMaster.ui.sync=function(){var k=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},a,f,c=[],m;function d(p){var o=[],e;for(e=0;e<p.frames.length;e++){if(p.frames[e].UIMaster){o=o.concat(p.frames[e].UIMaster.syncList);p.frames[e].UIMaster.syncList=[]}o=o.concat(d(p.frames[e]))}return o}function b(e){k.lastIndex=0;return k.test(e)?'"'+e.replace(k,function(o){return typeof n[o]==="string"?n[o]:"\\u"+("0000"+o.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function j(p){var o,e=[];for(o in p){e.push(b(o)+":"+b(typeof p[o]=="string"?p[o]:String(p[o])))}return"{"+e.join(",")+"}"}try{a=window.top.UIMaster?window.top.UIMaster.syncList:[];window.top.UIMaster&&(window.top.UIMaster.syncList=[])}catch(h){a=[]}var l=d(window.top);a=a.length?a.concat(l):(l.length?l.concat(a):[]);for(f=0;f<a.length;f++){c[f]=j(a[f])||"null"}m=c.length===0?"[]":"["+c.join(",")+"]";return m};UIMaster.ui.sync.set=function(a){UIMaster.syncList.push(a)};function postInit(){while(UIMaster.initList.length>0){var a=UIMaster.initList.shift();var b=a.Form.items;for(var c=0;c<b.length;c++){if(b[c]){b[c].postInit&&b[c].postInit()}}a.user_constructor()}while(UIMaster.pageInitFunctions.length>0){var d=UIMaster.pageInitFunctions.shift();d()}}UIMaster.ui.field=UIMaster.extend(UIMaster.ui,{flag:false,validate:null,oldInvalidF:false,validator:null,validators:null,invalidText:null,disableValid:function(){this.flag=null;clearConstraint(this.name)},enableValid:function(){this.flag=false},markInvalid:function(){constraint(this.name,this.invalidText)},clearInvalid:function(){clearConstraint(this.name)},removeIndicator:function(){$("#"+this.name+"div").remove()},markRequired:function(){setRequiredStyle(UIMaster.getUIID(this))},addValidator:function(a,b){this.validators.push({func:a,msg:b})},sync:function(){this.notifyChange(this)},validateEvent:function(b){var a=UIMaster.getObject(b);return a.validate?a.validate():false},validateCustConstraint:function(b){var d;if(b.param){var a="",c;for(c=0;c<b.param.length;c++){a+=(c==0?"":",")+"v.param["+c+"]"}d=new Function("v","c","return v.func.call(c,"+a+");")(b,this)}else{d=b.func.call(this)}if(typeof d=="string"){b.msg=d;return !d}return d},init:function(){this.parentDiv=this.parentNode;this.addListener("blur",this.validateEvent);this.validators=this.validators||[];if(this.validator){this.validators.push(this.validator)}}});UIMaster.ui.textfield=UIMaster.extend(UIMaster.ui.field,{allowBlank:true,allowBlankText:"",regex:null,regexText:"",minLength:0,maxLength:-1,lengthText:"",needErrMsg:true,setValue:function(a){this.value=a;this.notifyChange(this)},getValue:function(){return this.value},checkMaxLength:function(b){if((this.maxLength>0)&&(this.value.length>=this.maxLength)){var a=window.event?b.keyCode:b.which;return((a==8)||((a>=35)&&(a<=40))||(a==46))}return true},checkMaxAfterInput:function(a){if(this.maxLength>0&&this.value.length>this.maxLength){this.value=this.value.substring(0,this.maxLength)}},validate:function(c){var a=[];if(this.flag!=null){if(!this.oldInvalidF){clearConstraint(this.name)}if(!this.allowBlank&&$.trim(this.value).length<1){a.push(this.allowBlankText)}else{if(containXSS(this.value)){a.push("Illegal character.")}else{if((this.minLength>0)&&(this.value.length<this.minLength)){a.push(this.lengthText)}if((this.maxLength>0)&&(this.value.length>this.maxLength)){a.push(this.lengthText)}if(this.regex&&!this.regex.test(this.ui.value)){a.push(this.regexText)}if(this.validators!=null&&this.validators.length!=0){for(var b=0;b<this.validators.length;b++){this.validateCustConstraint(this.validators[b])||a.push(this.validators[b].msg||"")}}}}if(a.length>0){if(this.needErrMsg===true){constraint(this.name,a.join(" * "))}setConstraintStyle(this)}}return a.length>0?a:null},parseCurrency:function(){return UIMaster.parseCurrency(g(this,"locale"),g(this,"currencyformat"),this.value)},notifyChange:function(b){var a=UIMaster.getObject(b);this.needErrMsg=true;if(a._v==a.value){return}if(!(a.validate?a.validate():false)){UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(a),_valueName:"value",_value:a.value,_framePrefix:UIMaster.getFramePrefix(a)});a._v=a.value}},init:function(){UIMaster.ui.textfield.superclass.init.call(this);this.removeListener("blur",this.validateEvent);this._v=this.value;this.regex&&(this.regex=new RegExp(this.regex));if(this.ui&&!this.defaultBackgroundImage){if(UIMaster.browser.msie){this.defaultBackgroundImage=this.currentStyle.backgroundImage}else{try{this.defaultBackgroundImage=document.defaultView.getComputedStyle(this,null).getPropertyValue("background-image")}catch(e){}}}var f=this.onblur;this.onblur=null;$(this).bind("blur",this.notifyChange).bind("keyup",function(e){this.needErrMsg=false;if((e.which==9)||(e.which==13)||(e.which==16)||(e.which==17)||(e.which==18)||(e.which==20)){return}else{this.validateEvent(e)}});f&&$(this).bind("blur",f);var v0=g(this,"validationFlag");var v1=eval(g(this,"allowBlank"));var v2=g(this,"allowBlankText");var v3=g(this,"regex");var v4=g(this,"regexText");var v5=g(this,"minLength");var v6=g(this,"lengthText");var v7=g(this,"maxLength");if(v0){this.flag=null}this.allowBlank=v1==null?this.allowBlank:v1;if(!this.allowBlank&&(this.value=="")){setConstraintStyle(this)}if(v2){this.allowBlankText=v2}!this.allowBlank&&this.allowBlankText===""&&(this.allowBlankText=UIMaster.i18nmsg(C+"||ALLOW_BLANK"));if(v3){this.regex=new RegExp(v3)}if(v4){this.regexText=v4}this.regex&&this.regexText===""&&(this.regexText=UIMaster.i18nmsg(C+"||REGULAR_EXPRESSION"));if(v5){this.minLength=Number(v5)}if(v6){this.lengthText=v6}v5&&this.lengthText===""&&(this.lengthText=UIMaster.i18nmsg(C+"||MINIMUM_LENGTH"));$(this).bind("keydown",this.checkMaxLength);$(this).bind("keyup",this.checkMaxAfterInput);if(v7){this.maxLength=Number(v7)}if($(this).attr("needamount")){this.amountFunction()}},amountFunction:function(){var a=this;$($(this).next()).click(function(){});$($(this).next().next()).click(function(){})}});UIMaster.ui.textarea=UIMaster.extend(UIMaster.ui.textfield,{hiddenToolbar:false,persistable:true,initialized:false,ckeditor:null,init:function(){if(this.initialized){return}this.initialized=true;UIMaster.ui.textarea.superclass.init.call(this);if($(this).attr("htmlsupport")=="true"){this.initHtmlContent()}},addAttr:function(b){$(this).attr(b.name,b.value);$(this).text(b.value)},initHtmlContent:function(){var c=this;if(this.persistable){var a=$("<button>Save</button>");$(this).parent().append(a);a.button().click(function(){var d=CKEDITOR.instances[c.name+"_ckeditor"].getData();$.ajax({url:AJAX_SERVICE_URL,async:false,type:"POST",data:{_ajaxUserEvent:"htmleditor",_uiid:c.name,_valueName:"save",_value:d,_framePrefix:UIMaster.getFramePrefix(c)}})})}var b=null;if(this.hiddenToolbar){b={uiColor:"#0078AE",toolbar:[]}}else{b={uiColor:"#0078AE"}}setTimeout(function(){CKEDITOR.replace(c.name+"_ckeditor",b);c.ckeditor=CKEDITOR.instances[c.name+"_ckeditor"]},500)},getHTMLText:function(){return this.ckeditor.getData()},clearHTMLText:function(){this.ckeditor.updateElement();this.ckeditor.setData("")},appendHTMLText:function(a){if(this.ckeditor!=null){this.ckeditor.insertHtml(a)}}});UIMaster.ui.countdown=UIMaster.extend(UIMaster.ui.textfield,{initialized:false,labelsOptions:{lang:{days:"\u5929",hours:"\u65F6",minutes:"\u5206",seconds:"\u79D2"}},init:function(){if(this.initialized){return}this.initialized=true;var a=parseInt($(this).attr("count"));$(this).redCountdown({preset:"flat-colors-fat",end:($.now()+a),labelsOptions:this.labelsOptions,onEndCallback:this.onEndCall})},onEndCall:function(){}});UIMaster.ui.calendar=UIMaster.extend(UIMaster.ui.textfield,{isDataOnly:false,isBiggerThan:false,isSmallerThan:false,editableFlag:true,dateConstraint:"",format:"",dateType:"date",init:function(){UIMaster.ui.calendar.superclass.init.call(this);this.selectDate=this.ui.nextElementSibling;if(this.className.toLowerCase().indexOf("readonly")>0){this.editableFlag=false}else{this.editableFlag=true}if(this.editableFlag==false){this.disableValid();this.selectDate.style.display="none"}if(!this.allowBlank){this.allowBlank=false;if(this.editableFlag==true){setRequiredStyle(this.name);if(this.value==""){setConstraintStyle(this)}}}this.allowBlank||(this.allowBlankText=UIMaster_getI18NInfo("Common||ALLOW_BLANK"));this.date=this.parseDate(this,this.format,this.dateType);this.getDate=function(){return this.date};this.setDate=function(b){var a=UIMaster_getFormattedDate(this.format,this.dateType,b,"");this.value=a;this.date=b;this.validate();if(!this.readOnly&&!this.disabled&&($(this).css("display")!="none")){this.focus()}};this.setEditable=function(a){this.editableFlag=a;if(a){this.enableValid();this.selectDate.style.display="inline";this.validate()}else{this.disableValid();this.selectDate.style.display="none";this.clearInvalid()}};this.setValue=function(a){if(typeof a=="string"){this.value=a;this.date=this.parseDate(this,this.format,this.dateType);this.notifyChange(this)}else{if(typeof a=="date"){this.setDate(a)}}};this.isDateValid=function(n){var e=new Date(n.getTime());e.setHours(0,0,0,0);var h=this.dateConstraint,q,l=e.getDate(),f=e.getMonth()+1;for(var j=0;j<h.length;j++){q=h[j];if(q[0]=="R"){var t=/(\d{4})\/(\d{1,2})\/(\d{1,2})/,s=null,p=q[1]=="null"||(s=q[1].match(t))!=null&&e>=new Date(parseInt(s[1],10),parseInt(s[2],10)-1,parseInt(s[3],10)),c=q[2]=="null"||(s=q[2].match(t))!=null&&e<=new Date(parseInt(s[1],10),parseInt(s[2],10)-1,parseInt(s[3],10));if(p&&c){return false}}else{if(q[0]=="W"){if(e.getDay()==parseInt(q[1],10)){return false}}else{if(q[0]=="M"){if((l>=parseInt(q[1],10))&&(l<=parseInt(q[2],10))){return false}}else{if(q[0]=="Y"){var a=/(\d{1,2})\/(\d{1,2})/,s=null,p=false,c=false;if((s=q[1].match(a))!=null){var o=parseInt(s[1],10),b=parseInt(s[2],10);p=f>o||(f==o&&l>=b)}if((s=q[2].match(a))!=null){var k=parseInt(s[1],10),r=parseInt(s[2],10);c=f<k||(f==k&&l<=r)}if(p&&c){return false}}}}}}return true};this.beforeShowDay=function(a){if((this.parentEntity==undefined)||(this.parentEntity.beforeShowDay==undefined)){return[this.isDateValid(a),""]}else{return[this.isDateValid(a)&&this.parentEntity.beforeShowDay(this,a),""]}}},parseDate:function(c,a,b){if(c.value.length){return isNaN(parseInt(c.value))?null:new Date(parseInt(c.value))}else{return null}},open:function(){if(this.editableFlag){LANG=="en"||UIMaster.require("/js/controls/i18n/ui.datepicker-"+LANG+".js",true);this.showCalendar(this,this.format,this.dateType)}},showCalendar:function(a,h,b){var c=$(a),e=a.getDate(),j=new Date(CURTIME),f=a.beforeShowDay,d=a,k;j=new Date(CURTIME+j.getTimezoneOffset()*60000+TZOFFSET);$.datepicker.regional[LANG];k=e?e:j;c.datepicker({defaultDate:k,dateFormat:"yy-mm-dd",duration:"fast",today:j,changeMonth:true,changeYear:true,constrainInput:false,yearRange:"-80:+20"});if(jQuery.datepicker._datepickerShowing&&jQuery.datepicker._lastInput==a){return}jQuery.datepicker._showDatepicker(a)},notifyChange:function(b){var a=UIMaster.getObject(b);this.needErrMsg=true;if(a._v==a.value){return}if(!(a.validate?a.validate():false)){UIMaster.ui.sync.set({_uiid:this.name,_valueName:"value",_value:a.value,_framePrefix:UIMaster.getFramePrefix(a)});a._v=a.value}},validator:{msg:"Calender value format is wrong.",func:function(){var b=this.isBiggerThan,e=this.isSmallerThan;var d=this.parseDate(this,this.format,this.dateType),a=new Date(CURTIME);a=new Date(CURTIME+a.getTimezoneOffset()*60000+TZOFFSET);if(this.dateType=="date"){a.setHours(0,0,0,0)}if(this.value.length){if(b&&e&&(!d||d.getTime()!=a.getTime())){return UIMaster_getI18NInfo("Common||INPUT_DATE_CONSTRAINT_TODAY")}else{if(d<=a&&b){return UIMaster_getI18NInfo("Common||INPUT_DATE_CONSTRAINT_GREATER")}else{if(d>=a&&e){return UIMaster_getI18NInfo("Common||INPUT_DATE_CONSTRAINT_SMALLER")}}}if((this.lastInputDateValue==undefined)||(this.lastInputDateValue!=this.value)){this.lastInputDateValue=this.value;if(!this.allowBlank||!(/^\s*$/.test(this.value))){if((d==null)||(this.isDateValid(d)==false)){this.date=undefined;this.lastInputDateValid=false;return UIMaster_getI18NInfo("Common||INPUT_DATE_CONSTRAINT_INVALID")}if(d!=null){var c=a.getFullYear(),f=d.getFullYear();if(((f>=c)&&(f-c<=20))||((f<c)&&(f-c>-80))){this.date=d;this.lastInputDateValid=true}else{this.date=undefined;this.lastInputDateValid=false;return UIMaster_getI18NInfo("Common||INPUT_DATE_CONSTRAINT_INVALID")}}}}else{if(this.lastInputDateValid==false){return UIMaster_getI18NInfo("Common||INPUT_DATE_CONSTRAINT_INVALID")}}}else{this.date=undefined}return true}}});UIMaster.ui.passwordfield=UIMaster.extend(UIMaster.ui.textfield);UIMaster.ui.checkbox=UIMaster.extend(UIMaster.ui.field,{mustCheck:false,mustCheckText:"",setValue:function(a){this.checked=a;this.notifyChange(this)},getValue:function(){return this.checked?this.value:""},validate:function(c){var a=[];if(this.flag!=null){if(!this.oldInvalidF){clearConstraint(this.name)}if(this.mustCheck&&this.checked!=this.mustCheck){a.push(this.mustCheckText)}if(this.validators.length!=0){for(var b=0;b<this.validators.length;b++){this.validateCustConstraint(this.validators[b])||a.push(this.validators[b].msg||"")}}if(a.length>0){constraint(this.name,a.join(" * "))}}return a.length>0?a:null},notifyChange:function(b){var a=UIMaster.getObject(b);if(!!a._v==!!a.checked){return}if(!(a.validate?a.validate():false)){UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(a),_valueName:"selected",_value:a.checked,_framePrefix:UIMaster.getFramePrefix(a)});a._v=a.checked}},init:function(){UIMaster.ui.checkbox.superclass.init.call(this);this._v=this.checked;var f=this.onclick;this.onclick=null;$(this).bind("click",this.notifyChange);f&&$(this).bind("click",f);var v1=eval(g(this,"mustCheck"));var v2=g(this,"mustCheckText");this.mustCheck=v1!=null?v1:this.mustCheck;if(v2){this.mustCheckText=v2}}});UIMaster.ui.radiobutton=UIMaster.extend(UIMaster.ui.checkbox,{notifyChange:function(b){var a=UIMaster.getObject(b);if(a._v==a.checked){return}var c=a.inList?a.name+"["+a.value+"]":a.name;if(!(a.validate?a.validate():false)){UIMaster.ui.sync.set({_uiid:c,_valueName:"selected",_value:a.checked,_framePrefix:UIMaster.getFramePrefix(a)});a._v=a.checked}}});UIMaster.ui.checkboxgroup=UIMaster.extend(UIMaster.ui.field,{mustCheck:null,mustCheckText:"",setEnabled:function(a){if(this.length){for(var b=0;b<this.length;b++){a?this[b].disabled=false:this[b].disabled=true}}},addAttr:function(b){if(b.item){var d=$(this.p).attr("name");var c=$('<input type="checkbox" id="'+b.value+'" name="'+d+'" value="'+b.value+'" class="uimaster_checkboxGroup"/><label class="uimaster_checkout_text_gap" for="'+b.value+'">'+b.name+"</label>");$(this.p).append(c);this.push(c[0])}else{if(b.finish){this.initialized=false;this.init()}}},removeAttr:function(a){this.clearOptions()},clearOptions:function(){while(this.length>0){this.splice(0,1)}$(this.p).children().each(function(){$(this).remove()});this._v=null},setValue:function(e){var a=e||[];if(this.length){for(var d=0;d<a.length;d++){for(var b=0;b<this.length;b++){if(this[b].value==a[d]){this[b].checked=true;break}else{this[b].checked=false}}}}else{this.checked=e}this.notifyChange(this.nodeType?this:this[0])},getValue:function(){var a=[];if(this.length){for(var b=0;b<this.length;b++){if(this[b].checked){a.push(this[b].value)}else{if(this.checked){a.push(this.value)}}}}return a},validateEvent:function(evnt){var obj=UIMaster.getObject(evnt);return eval(D+obj.name)&&eval(D+obj.name).validate()},notifyChange:function(e){var obj=eval(D+UIMaster.getObject(e).name),v=obj.getValue().join(",");if(obj._v==v){return}if(!(obj.validate?obj.validate():false)){UIMaster.ui.sync.set({_uiid:UIMaster.getObject(e).name,_valueName:"values",_value:obj.getValue().join(","),_framePrefix:UIMaster.getFramePrefix(UIMaster.getObject(e))});obj._v=v}},validate:function(c){var a=[];if(this.length&&this.flag!=null){if(!this.oldInvalidF){clearConstraint(this.nodeType?this.name:this[0].name)}if(this.mustCheck){if(!UIMaster.arrayContain(this.mustCheck,this.getValue())){a.push(this.mustCheckText)}}if(this.validators.length!=0){for(var b=0;b<this.validators.length;b++){this.validateCustConstraint(this.validators[b])||a.push(this.validators[b].msg||"")}}if(a.length>0){constraint(this.nodeType?this.name:this[0].name,a.join(" * "))}}return a.length>0?a:null},sync:function(){this.notifyChange(this.nodeType?this:this[0])},getDefaultValue:function(){var a=[];if(this.length){for(var b=0;b<this.length;b++){if(this[b].defaultSelected){a.push(this[b].value)}else{if(this.defaultSelected){a.push(this.value)}}}}return a},setLabelText:function(a){var b=this.nodeType?this:this[0];b.previousSibling?b.previousSibling.childNodes[0].nodeValue=a:$(b).before($("<label></label>").attr({id:b.name+"_widgetLabel","for":b.name}).addClass("uimaster_widgetLabel").css("display","block").text(a))},removeIndicator:function(){$("#"+(this.nodeType?this.name:this[0].name)+"div").remove()},addListener:function(c,b){if(this.length){for(var a=0;a<this.length;a++){$(this[a]).bind(c,b)}}else{$(this).bind(c,b)}},removeListener:function(d,c,a){if(this.length){for(var b=0;b<this.length;b++){$(this[b]).unbind(d,c)}}else{$(this).unbind(d,c)}},initV:function(){this._v=this.getDefaultValue().join(",")},init:function(){if(this.initialized){return}this.initialized=true;this.p=$(this).parent();this.parentDiv=this.nodeType?this.parentNode.parentNode:this[0].parentNode.parentNode;this.initV();this.validators=[];if(this.validator){this.validators.push(this.validator)}if(this.length){for(var a=0;a<this.length;a++){this[a].parentEntity=this.parentEntity;this[a].arrayIndex=a;this[a].setVisible=UIMaster.ui.checkboxgroup.superclass.setVisible}}this.addListener("click",this.notifyChange,false);this.addListener("blur",this.validateEvent,false);if(this.nodeType){var c=this.onclick;this.onclick=null;c&&$(this).bind("click",c)}else{if(this.onchangeEvent==null){this.onchangeEvent=this[0].onchange}for(var a=0;a<this.length;a++){var c=this[a].onclick;var b=this[a].onchange;this[a].onclick=null;c&&$(this[a]).bind("click",c);if(b==null){$(this[a]).bind("change",this.onchangeEvent)}}}}});UIMaster.ui.radiobuttongroup=UIMaster.extend(UIMaster.ui.checkboxgroup,{addAttr:function(b){if(b.item){var d=$(this.p).attr("name");var c=$('<input type="radio" id="'+b.value+'" name="'+d+'" value="'+b.value+'" class="uimaster_radioButtonGroup"/><label class="uimaster_radio_text_gap" for="'+b.value+'">'+b.name+"</label>");$(this.p).append(c);this.push(c[0])}else{if(b.finish){this.initialized=false;this.init()}}},setValue:function(b){if(this.length){for(var a=0;a<this.length;a++){this[a].checked=(this[a].value==b?true:false)}}else{this.checked=(this.value==b?true:false)}this.notifyChange(this.nodeType?this:this[0])},getValue:function(){if(this.length){for(var a=0;a<this.length;a++){if(this[a].checked){return arguments.callee.caller==this.validate?[this[a].value]:this[a].value}}}},getDefaultValue:function(){if(this.length){for(var a=0;a<this.length;a++){if(!!this[a].defaultChecked){return this[a].value}}}},notifyChange:function(e){var rBtn=UIMaster.getObject(e),obj=eval(D+rBtn.name);if(e==undefined||obj._v==obj.getValue()){return}var uiid=obj.inList?rBtn.name.lastIndexOf("]")!=rBtn.name.length-1?rBtn.value=="on"?rBtn.name:rBtn.name+"["+rBtn.value+"]":rBtn.name:rBtn.name;if(!(obj.validate?obj.validate():false)){UIMaster.ui.sync.set({_uiid:uiid,_valueName:"value",_value:obj.getValue(),_framePrefix:UIMaster.getFramePrefix(rBtn)});obj._v=obj.getValue()}},initV:function(){this._v=this.getDefaultValue()}});UIMaster.ui.combobox=UIMaster.extend(UIMaster.ui.field,{allowBlank:true,allowBlankText:"",selectValue:null,selectValueText:"",setValue:function(c,a){this.value=c;if(a){for(var d=0;d<this.options.length;d++){if(this.options[d].value==c){this.options[d].selected=true;break}}}this.notifyChange(this)},getValue:function(){return arguments.callee.caller==this.validate?[this.value]:this.value},getDefaultValue:function(){for(var a=0;a<this.options.length;a++){if(this.options[a].defaultSelected){return this.options[a].value}}},addAttr:function(b){if(b.item){$(this).append($("<option></option>").attr("value",b.value).text(b.name))}else{this.setValue(b.value,true)}},removeAttr:function(a){if(a!=null&&a.indexOf("CLEAR_ALL_ITEMS")==-1){for(var b=0;b<this.options.length;b++){if(this.options[b].value==a){$(this.options[b]).remove();break}}}else{this.clearOptions()}},addOption:function(a){$(this).append($("<option></option>").attr("value",a.value).text(a.name))},clearOptions:function(){$(this).children().remove()},validate:function(d){var b=[];if(this.options&&this.flag!=null){if(!this.oldInvalidF){clearConstraint(this.name)}if(!this.allowBlank&&(this.value==""||this.value=="_NOT_SPECIFIED")){b.push(this.allowBlankText)}if(this.selectValue){var a=this.getValue();if(!UIMaster.arrayContain(this.selectValue,a)){b.push(this.selectValueText)}}if(this.validators.length!=0){for(var c=0;c<this.validators.length;c++){this.validateCustConstraint(this.validators[c])||b.push(this.validators[c].msg||"")}}if(b.length>0){constraint(this.name,b.join(" * "))}}if(this.style){this.style.backgroundColor=b.length>0?CONSTRAINT_BACKGROUNDCOLOR:"#FFFFFF"}else{$(this).parent()[0].style.backgroundColor=b.length>0?CONSTRAINT_BACKGROUNDCOLOR:"#FFFFFF"}return b.length>0?b:null},notifyChange:function(c,a){var b=UIMaster.getObject(c);if(!(b.validate?b.validate():false)||a){UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(b),_valueName:"value",_value:b.getValue(),_framePrefix:UIMaster.getFramePrefix(b)})}},init:function(){UIMaster.ui.combobox.superclass.init.call(this);var f=this.onchange;this.onchange=null;$(this).bind("change",this.notifyChange);f&&$(this).bind("change",f);var v1=eval(g(this,"allowBlank"));var v2=g(this,"allowBlankText");this.allowBlank=v1==null?this.allowBlank:v1;if(v2){this.allowBlankText=v2}!this.allowBlank&&this.allowBlankText===""&&(this.allowBlankText=UIMaster.i18nmsg(C+"||ALLOW_BLANK"));$("option",$(this)).each(function(i){$(this).attr("title",$(this).text())})}});UIMaster.ui.list=UIMaster.extend(UIMaster.ui.combobox,{syncedValue:null,setValue:function(a){for(var c=0;c<a.length;c++){for(var b=0;b<this.options.length;b++){if(this.options[b].value==a[c]){this.options[b].selected=true;break}}}this.notifyChange(this)},getValue:function(){var a=[];for(var b=0;b<this.options.length;b++){if(this.options[b].selected){a.push(this.options[b].value)}}return a},getDefaultValue:function(){var a=[];for(var b=0;b<this.options.length;b++){if(this.options[b].defaultSelected){a.push(this.options[b].value)}}return a},notifyChange:function(h,d){var f=UIMaster.getObject(h);if(!(f.validate?f.validate():false)||d){if(this.syncedValue!=null){var c=-1,a=UIMaster.syncList.length;for(var b=0;b<a;b++){if(UIMaster.syncList[b]==this.syncedValue){c=b;break}}if(c>-1){UIMaster.syncList.splice(c,1)}}this.syncedValue={_uiid:UIMaster.getUIID(f),_valueName:"values",_value:f.getValue().join(";"),_framePrefix:UIMaster.getFramePrefix(f)};UIMaster.ui.sync.set(this.syncedValue)}}});UIMaster.ui.container=UIMaster.extend(UIMaster.ui.field,{items:null,validationList:null,flag:true,setVisible:function(a){for(var b=0;b<this.items.length;b++){this.items[b].setVisible&&this.items[b].setVisible(a)}},enable:function(){for(var a=0;a<this.items.length;a++){this.items[a].setEnabled&&this.items[a].setEnabled(true)}},disable:function(){for(var a=0;a<this.items.length;a++){this.items[a].setEnabled&&this.items[a].setEnabled(false)}},disableValid:function(){for(var a=0;a<this.validationList.length;a++){this.validationList[a].disableValid&&this.validationList[a].disableValid()}},enableValid:function(){for(var a=0;a<this.validationList.length;a++){this.validationList[a].enableValid&&this.validationList[a].enableValid()}},validate:function(e){var a=[];if(this.flag!=null){if(this.parentEntity.initPageJs){UIMaster.clearErrMsg()}}for(var c=0;c<this.validationList.length;c++){var b=null;if(e==undefined){b=this.validationList[c].validate()}if(this.validationList[c].allowBlank==false){setRequiredStyle(this.validationList[c].name)}if(b!=null){for(var d in this.parentEntity){if(this.parentEntity[d]==this.validationList[c]){a.push([d,b]);this.validationList[c].parentDiv&&UIMaster.appendPanelErr(this.validationList[c].parentDiv.id,b);break}}}}return a.length>0?a:null},sync:function(){if(this.items==null){return}for(var a=0;a<this.items.length;a++){this.items[a].sync&&(this.items[a].ui||this.items[a].Form||this.items[a] instanceof Array)&&this.items[a].sync()}},addComponentValidate:function(a){if(a instanceof Array){for(var c=0;c<a.length;c++){if(a[c].component instanceof Array){for(var b=0;b<a[c].component.length;b++){a[c].component[b].validators.push(a[c])}}else{this.parentEntity.validators.push(a[c])}}}},init:function(){UIMaster.ui.container.superclass.init.call(this);this.addComponentValidate(this.validator);if(!this.validationList){this.validationList=[];for(var a=0;a<this.items.length;a++){if(this.items[a]&&this.items[a].validate){this.validationList.push(this.items[a])}}}this.removeListener("blur",this.validateEvent,false);this.validate(this.flag);this.parentEntity.initialized=true}});UIMaster.ui.panel=function(conf){function parseInitPageJs(){if(this.initPageJs){UIMaster.ui.mask.open();var oIPJS=this.initPageJs,comment,nodes=this.sync?$(this.Form):$(this);this.initPageJs=function(){if(!jQuery.isReady){jQuery.ready()}postInit();oIPJS.call(this);focusFirstTextField()};UIMaster.ui.mask.close();if(this.parentDiv&&$(this.parentDiv).length>0){if($(this.parentDiv).is("form")){$(this.parentDiv).css("display","block")}else{var p=$(this.parentDiv);while(!(p=p.parent()).is("form")){}p.css("display","block")}}else{$(document).find("form").css("display","block")}}}if(conf.items&&conf.items.length>0){UIMaster.apply(this,{Form:new UIMaster.ui.container(conf),disableValid:function(){this.Form.disableValid()},enableValid:function(){this.Form.enableValid()},disable:function(){this.Form.disable()},enable:function(){this.Form.enable()},sync:function(){this.Form.sync()},validate:function(){var r=this.Form.validate();r=r||[];var a=[];clearConstraint(this.Form.id);for(var i=0;i<this.validators.length;i++){if(!this.validators[i].func.call(this)){a.push(this.validators[i].msg)}}if(a.length){constraint(this.Form.id,a.join(" * "));if(!this.name.nodeType){r.push([this.name,a.join(" * ")])}else{r.push(["panel",a.join(" * ")])}}return r.length>0?r:null},validators:[],addComponent:function(c,v,n){n&&(this[n]=c);c.parentEntity=this;!c.initialized&&c.init();this.Form.items.push(c);v&&c.validate&&this.Form.validationList.push(c);if(c.allowBlank==false){setRequiredStyle(c.name)}if(c.subComponents){for(var i=0;i<c.subComponents.length;i++){this.addComponent(eval(D+c.subComponents[i]),true)}}},removeComponent:function(c){if(c==undefined){return}if(c.subComponents!=undefined){for(var i=0;i<c.subComponents.length;i++){this.removeComponent(eval(D+c.subComponents[i]))}}for(var i in this){if(this[i]==c){delete this[i];for(var k=0;k<this.Form.validationList.length;k++){if(this.Form.validationList[k]==c){this.Form.validationList.splice(k,1);break}}for(var k=0;k<this.Form.items.length;k++){if(this.Form.items[k]==c){this.Form.items.splice(k,1);break}}break}}},releaseFormObject:function(){var formName=this.Form.id.substring(0,this.Form.id.lastIndexOf("."));for(i in elementList){if(i.substr(0,formName.length)==formName){delete elementList[i]}}this.Form.items=null;delete this.Form},setLabelText:function(txt){this.Form.setLabelText(txt)},init:function(){var ui=this.Form.ui;if(ui&&!this.name){var name=(typeof ui.name=="string")?ui.name:ui.id;if(name){var n=name.split(".");n.pop();this.name=n.join(".")+"."}else{this.name=""}}var items=this.Form.items;for(var i=0;i<items.length;i++){if(items[i]){items[i].parentEntity=this;if(!items[i].initialized){items[i].init&&(items[i].ui||items[i].Form||items[i] instanceof Array)&&items[i].init()}}}this.Form.parentEntity=this;this.parentDiv=this.Form.parentNode;if("TitlePanel"==this.Form.uiskin){this.parentDiv=this.parentDiv.parentNode.parentNode.parentNode.parentNode}else{if("FoldingPanel"==this.Form.uiskin){this.parentDiv=this.parentDiv.parentNode.parentNode.parentNode.parentNode.parentNode}}this.Form.init();this.user_constructor&&(defaultname&&defaultname.Form||defaultname&&defaultname[this.Form.id.split(".")[0]]?this.user_constructor():UIMaster.initList.push(this));parseInitPageJs.apply(this)},user_constructor:null})}else{UIMaster.apply(this,conf);UIMaster.apply(this,{validate:function(){var result=new Array();if(this.subComponents.length>0){for(var i=0;i<this.subComponents.length;i++){var comp=elementList[this.subComponents[i]];if(comp&&comp.validate){var r=comp.validate();if(r!=null&&r.length>0){result.push(r)}}}}return result.length>0?result:null},init:function(){if(this.subComponents.length>0){for(var i=0;i<this.subComponents.length;i++){var comp=elementList[this.subComponents[i]];if(comp){comp.parentEntity=this.parentEntity;!comp.initialized&&comp.init&&comp.init()}}}this.parentDiv=this.parentNode;this.user_constructor&&(defaultname&&defaultname.Form||defaultname&&defaultname[this.Form.id.split(".")[0]]?this.user_constructor():UIMaster.initList.push(this));this.initialized=true;if("TitlePanUIMaster"==this.uiskin){this.parentDiv=this.parentDiv.parentNode.parentNode.parentNode.parentNode}else{if("FoldingPanel"==this.uiskin){this.parentDiv=this.parentDiv.parentNode.parentNode.parentNode.parentNode.parentNode}}parseInitPageJs.apply(this)},sync:function(){if(this.subComponents.length>0){for(var i=0;i<this.subComponents.length;i++){var comp=elementList[this.subComponents[i]];comp&&comp.sync&&comp.sync()}}}});UIMaster.apply(this.ui,this);return this.ui}};UIMaster.ui.button=UIMaster.extend(UIMaster.ui,{init:function(){this.parentDiv=this.parentNode}});UIMaster.ui.hidden=UIMaster.extend(UIMaster.ui,{sync:function(){if(this.value!=this._v){this.notifyChange(this)}},notifyChange:function(b){var a=UIMaster.getObject(b);UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(a),_valueName:"value",_value:a.value,_framePrefix:UIMaster.getFramePrefix(a)});a._v=a.value},n:function(a){if(a.originalEvent.propertyName=="value"||a.originalEvent.attrName=="value"){this.notifyChange(a.originalEvent)}},setValue:function(a){this.value=a},init:function(){$(this).bind("propertychange",this.n).bind("DOMAttrModified",this.n);this.parentDiv=this;this._v=this.value}});UIMaster.ui.label=UIMaster.extend(UIMaster.ui.hidden,{captureScreen:false,setLabelText:function(b){var c=this.parentNode.parentNode,a=c.previousSibling?(c.previousSibling.nodeType==1?c.previousSibling:c.previousSibling.previousSibling):null;a?a.childNodes[0].nodeValue=b:$(c).before($("<label></label>").attr({id:this.name+"_widgetLabel","for":this.name}).addClass("uimaster_widgetLabel").css("display","block").text(b))},addAttr:function(b){this.setText(b.value)},setText:function(a){this.previousSibling?this.previousSibling.nodeValue=a:$(this).before(a)},init:function(){UIMaster.ui.label.superclass.init.call(this);this.parentDiv=this.parentNode.parentNode.parentNode;if(this.captureScreen){$(this).click(function(){html2canvas(document.body,{onrendered:function(b){var d=b.toDataURL("image/png").replace("image/png","image/octet-stream");var a=document.createElementNS("http://www.w3.org/1999/xhtml","a");a.href=d;a.download="vogerp-capture-"+Math.random()+".png";var c=document.createEvent("MouseEvents");c.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);a.dispatchEvent(c)}})})}}});UIMaster.ui.link=UIMaster.extend(UIMaster.ui.hidden,{init:function(){UIMaster.ui.link.superclass.init.call(this);this.parentDiv=this.parentNode}});UIMaster.ui.frame=UIMaster.extend(UIMaster.ui);UIMaster.ui.image=UIMaster.extend(UIMaster.ui,{height:-1,mobheight:-1,width:-1,mode:"standard",captureScreen:false,thumbnails:true,thumbnailsFullScreen:true,hideThumbnailsOnInit:false,slideshow:false,slideshowAutostart:false,intialized:false,enableSelectSync:true,init:function(){if(this.intialized){return}this.intialized=true;if(this.tagName.toLowerCase()=="div"){var a=this;var b;if(this.mobheight==-1){b={mode:this.mode,thumbnails:this.thumbnails,hideThumbnailsOnInit:this.hideThumbnailsOnInit,afterLoadPhoto:function(c){a.clickImage(c)}}}else{b={height:IS_MOBILEVIEW?this.mobheight:this.height,width:(IS_MOBILEVIEW?"100%":this.width),mode:this.mode,thumbnails:this.thumbnails,hideThumbnailsOnInit:this.hideThumbnailsOnInit,slideshow:this.slideshow,slideshowAutostart:this.slideshowAutostart,afterLoadPhoto:function(c){a.clickImage(c)}}}setTimeout(function(){try{$(a).jGallery(b)}catch(c){console.log(c)}},200)}if(this.captureScreen){$($(this).next()).click(function(){html2canvas(document.body,{onrendered:function(d){var f=d.toDataURL("image/png").replace("image/png","image/octet-stream");var c=document.createElementNS("http://www.w3.org/1999/xhtml","a");c.href=f;c.download="vogerp-capture-"+Math.random()+".png";var e=document.createEvent("MouseEvents");e.initMouseEvent("click",true,false,window,0,0,0,0,0,false,false,false,false,0,null);c.dispatchEvent(e)}})})}},clickImage:function(b){if(!this.enableSelectSync){return}var a={url:AJAX_SERVICE_URL,async:false,success:UIMaster.cmdHandler,data:{_ajaxUserEvent:"false",_uiid:this.id,_valueName:"selectedImage",_value:$(b).attr("src"),_framePrefix:UIMaster.getFramePrefix()}};if(MobileAppMode){_mobContext.ajax(JSON.stringify(a))}else{$.ajax(a)}},createAlbum:function(){var a=this;new UIMaster.ui.dialog({dialogType:UIMaster.ui.dialog.INPUT_DIALOG,message:"Enter a new name: ",messageType:UIMaster.ui.dialog.Information,optionType:UIMaster.ui.dialog.YES_NO_OPTION,title:"",height:150,width:300,handler:function(){if(this.value==null||this.value==""){return}var b={url:AJAX_SERVICE_URL,async:false,success:UIMaster.cmdHandler,data:{_ajaxUserEvent:"gallery",_uiid:a.id,_actionName:"createAlbum",_value:this.value,_framePrefix:UIMaster.getFramePrefix()}};if(MobileAppMode){_mobContext.ajax(JSON.stringify(b))}else{$.ajax(b)}}}).open()},refresh:function(a){$(this).jGallery().destroy();$(this).children().each(function(){$(this).remove()});$(decodeHTML(a)).appendTo($(this));this.intialized=false;this.init()}});UIMaster.ui.file=UIMaster.extend(UIMaster.ui,{initialized:false,callback:null,cleanAll:null,init:function(){if(this.initialized){return}this.initialized=true;var a=this;var l=this.nextElementSibling;var j=$(l).children()[0];var k=$(l).children()[1];var d=this.nextElementSibling.nextElementSibling;var b=d.nextElementSibling;var h=$(d).children();var e=h[0];var f=h[1];var m={beforeSend:function(){$(d).show();$(e).width("0%");$(b).empty();$(f).html("0%").css("background-color","lightblue")},uploadProgress:function(p,c,o,n){$(d).width(n+"%");$(f).html(n+"%");if(n>50){$(b).html("<font color='red'>\u4E0A\u4F20\u8FDB\u5EA6</font>")}},success:function(){if(IS_MOBILEVIEW){$(l).before($(a).parent())}else{$(l).before($(a))}$(e).width("100%");$(f).html("100%");if(a.callback!=null){a.callback(j)}},complete:function(c){$(b).html("<font color='blue'>\u4E0A\u4F20\u6210\u529F!</font>")},error:function(){$(b).html("<font color='red'>\u4E0A\u4F20\u9519\u8BEF!!!</font>")}};$(k).click(function(){if(a.cleanAll!=null){a.cleanAll(j)}});$(j).click(function(){var q=$(a).attr("suffix");if(q=="undefined"||q==""){alert("Wrong file widget with the empty suffix!");return}if(a.value==""){alert("\u8BF7\u9009\u62E9\u4E00\u4E2A\u6587\u4EF6!");return}var r=a.value;var p=r.lastIndexOf(".");if(p==-1){alert("Please choose a file with this suffix: "+q);return}var c=r.substring(p+1).toLowerCase();if(q.toLowerCase().indexOf(c)==-1){alert("Please choose a file with this suffix: "+q);return}var o=UIMaster.getFramePrefix(UIMaster.El(a).get(0));var n=$("<form action="+WEB_CONTEXTPATH+"/uploadFile?_uiid="+a.name+"&_framePrefix="+o+" method=post enctype=multipart/form-data></form>");if(IS_MOBILEVIEW){$(n).append($(a).parent())}else{$(n).append($(a))}$(n).ajaxSubmit(m);return})}});function decodeHTML(a){var b={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return a.replace(/&(lt|gt|nbsp|amp|quot);/ig,function(d,c){return b[c]})}UIMaster.ui.objectlist=function(a){UIMaster.apply(this,a)};UIMaster.ui.objectlist=UIMaster.extend(UIMaster.ui,{initialized:false,initRefreshBody:false,dtable:null,isSingleSelection:false,isMultipleSelection:true,editablecell:false,selectedIndex:-1,selectedIndexs:[],selectNotify:[],columnIds:[],appendRowMode:false,refreshInterval:0,tbody:null,tfoot:null,init:function(){if(this.initialized){return}this.initialized=true;if(!IS_MOBILEVIEW){$(this).prev().children().each(function(){$(this).buttonset();$(this).removeAttr("style");$(this).children().each(function(){if($(this).attr("icon")!=undefined&&$(this).attr("icon")!=null){$(this).button({text:false,icons:{primary:$(this).attr("icon")}})}})})}var j=$(this).attr("selectMode");if(j=="Multiple"){this.isMultipleSelection=true;this.isSingleSelection=false}else{if(j=="Single"){this.isSingleSelection=true;this.isMultipleSelection=false}else{this.isSingleSelection=false;this.isMultipleSelection=false}}var a=this;var d=[{targets:0,orderable:false,render:this.renderSelection}];$($(this).find("thead").children()[0]).children().each(function(e){if($(this).attr("htmltype")=="HTML"||$(this).attr("htmltype")=="html"||$(this).attr("htmltype")=="Image"||$(this).attr("htmltype")=="image"){d.push({targets:e,orderable:false,render:a.renderSelection})}});this.tfoot=$($(this).find("tfoot")[0]);this.editable=(typeof($(this).prev().attr("editablecell"))!="undefined");try{var l=$(this).dataTable({paging:!this.editable,ordering:!this.editable,info:!this.editable,pageLength:10,filter:false,recordsFiltered:$(this).attr("recordsFiltered"),recordsTotal:$(this).attr("recordsTotal"),columnDefs:d,processing:false,serverSide:true,bServerSide:true,sServerMethod:"POST",fnDrawCallback:function(m,e){a.tbody=$(elementList[a.id]).children("tbody");a.refreshBodyEvents(a.tbody,true)}})}catch(k){console.log(k);return}this.dtable=l;if($(this).height()>$(document.body).height()){$(this).parent().height($(document.body).height()-150);$(this).parent().css("overflow-y","scroll")}this.dtable.fnSettings().ajax={async:false,url:AJAX_SERVICE_URL+"?r="+Math.random(),type:"POST",data:{_ajaxUserEvent:"table",_uiid:this.id,_actionName:"pull",_framePrefix:UIMaster.getFramePrefix(UIMaster.El(this.id).get(0)),_actionPage:this.parentEntity.__entityName}};var c=new Array();var b=0;$(elementList[this.id]).find("thead th").each(function(){c[b++]=$(this).attr("id")});this.columnIds=c;var f=$(elementList[this.id]).children("tbody");this.tbody=f;if(this.rowEmpty()){this.syncButtonGroup(false)}else{var h=0;this.tbody.children().each(function(){this._DT_RowIndex=h++;var m=($(this).children()[0]);if(m.innerHTML!=""){var e=a.renderSelection(m.innerHTML,"",this);m.innerHTML="";$(m).append(e)}});if(!this.initRefreshBody){this.refreshBodyEvents(f,true)}}if(this.refreshInterval>0){a.autoRefresh(a);window.setTimeout(function(){a.autoRefresh(a)},this.refreshInterval*1000)}if(this.tfoot.length==0){return}this.tfoot=$(this.tfoot[0]);if(this.editable){this.editablecell=true;this.syncCellEvent(f)}this.refreshFoot()},renderSelection:function(b,a,c){if(b.indexOf("radio,")==0){return'<input type="radio" name="selectRadio" index="'+b.substring(b.indexOf("radio")+6)+'" />'}if(b.indexOf("checkbox,")==0){return'<input type="checkbox" name="" index="'+b.substring(b.indexOf("checkbox")+9)+'"/>'}if(b.indexOf("&lt;div")!=-1||b.indexOf("&lt;span")!=-1){return decodeHTML(b)}return b},refreshFoot:function(){var b=this;var a=this.tfoot.find("th");a.each(function(){var e=$(this).children();for(var d=0;d<e.length;d++){if(e[d].tagName.toLowerCase()=="input"){$(e[d]).keydown(function(c){if(c.keyCode==13){if(b.editable){b.hideEditorOnCell(b.getTDIndex(b.preCell),b.preCell);b.preCell=null;b.refreshFoot()}else{b.sync();b.refresh(0)}}})}else{if(e[d].tagName.toLowerCase()=="select"){$(e[d]).change(function(){if(b.editable){b.hideEditorOnCell(b.getTDIndex(b.preCell),b.preCell);b.preCell=null;b.refreshFoot()}else{b.sync();b.refresh(0)}})}else{if(e[d].tagName.toLowerCase()=="img"&&e[d].src.indexOf("calendar")!=-1){e[d].calendar=new UIMaster.ui.calendar({ui:$(e[d]).prev()[0]});e[d].calendar.init();$(e[d]).click(function(){this.calendar.open()});$(e[d]).prev().change(function(c){b.sync();b.refresh(0)})}}}}})},syncCellEvent:function(a){var b=this;$(a).find("td").each(function(){$(this).click(function(){if(b.preCell!=null&&b.preCell==this){return}if(b.preCell!=null){b.hideEditorOnCell(b.getTDIndex(b.preCell),b.preCell)}b.showEditorOnCell(b.getTDIndex(this),this);b.preCell=this})})},rowEmpty:function(){return this.tbody.find("td[class='dataTables_empty']").length==1},getTDIndex:function(b){var a=0;$(b).parent().children().each(function(){if(this==b){return false}a++});return a},showEditorOnCell:function(b,f){if(b==0||this.rowEmpty()){return}var e=$(f).text();this.tempCellValue=e;var d=this.tfoot.find("th");if($(d[b]).children().length==0){return}var c=$(d[b]).children()[0];var a=IS_MOBILEVIEW?$(c).children()[0].tagName.toUpperCase():c.tagName.toUpperCase();if(a=="INPUT"){if(IS_MOBILEVIEW){c.value=$(c).find("input")[0].value}else{c.value=e}}else{if(a=="SELECT"){$(c).children().each(function(){if($(this).text()==e){$(this).attr("selected",true);return false}})}}$(f).text("");$(f).append(c)},hideEditorOnCell:function(c,f){if(c==0||this.rowEmpty()||$(f).children().length==0){return}var d=$(f).children()[0];var e=this.tfoot.find("th");$(e[c]).children().remove();$(e[c]).append(d);var b=IS_MOBILEVIEW?$(d).children()[0].tagName.toUpperCase():d.tagName.toUpperCase();if(b=="INPUT"){var a=IS_MOBILEVIEW?($(d).find("input")[0].value):d.value;$(f).text(a);if(this.tempCellValue!=a){$(f).parent().attr("updated",true)}}else{if(b=="SELECT"){var a=$(d).find("option:selected").text();$(f).text(a);d.selectedIndex=-1;if(this.tempCellValue!=a){$(f).parent().attr("updated",true)}}}},syncButtonGroup:function(a){var b=this.id.replace(/\./g,"_");if(this.rowEmpty()){a=false}if(IS_MOBILEVIEW){return}if(a){$("#"+b+"_openItem").button({disabled:false});$("#"+b+"_disableItem").button({disabled:false});$("#"+b+"_enableItem").button({disabled:false});$("#"+b+"_deleteItem").button({disabled:false})}else{$("#"+b+"_openItem").button({disabled:true});$("#"+b+"_disableItem").button({disabled:true});$("#"+b+"_enableItem").button({disabled:true});$("#"+b+"_deleteItem").button({disabled:true})}},sync:function(){var c=UIMaster.getObject(this);if(c._selectedIndex!=this.selectedIndex){UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(c),_valueName:"selectedIndex",_value:this.selectedIndex,_framePrefix:UIMaster.getFramePrefix(c)});c._selectedIndex=this.selectedIndex}if(this.isMultipleSelection){UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(c),_valueName:"selectedIndexs",_value:this.selectedIndexs.join(","),_framePrefix:UIMaster.getFramePrefix(c)})}if(this.editable){return}var a=$(elementList[this.id]).find("tfoot th");var b=new Array();a.each(function(){var e=$(this).children();for(var d=0;d<e.length;d++){if(e[d].tagName.toLowerCase()=="input"){b.push({name:e[d].name,value:e[d].value})}else{if(e[d].tagName.toLowerCase()=="select"){b.push({name:e[d].name,value:e[d].value})}}}});UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(c),_valueName:"conditions",_value:JSON.stringify(b),_framePrefix:UIMaster.getFramePrefix(c)})},syncBodyDataToServer:function(){if(this.editable){var c=this;var b=new Array();this.tbody.find("tr").each(function(){var e=new Object();var d=0;$(this).children().each(function(){e[c.columnIds[d++]]=$(this).text()});if($(this).attr("updated")=="true"){e.updated=true}b.push(e)});var a=UIMaster.getObject(this);UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(a),_valueName:"bodyJson",_value:JSON.stringify(b),_framePrefix:UIMaster.getFramePrefix(a)});return}},refreshBodyEvents:function(body,selectedByDefault){this.initRefreshBody=true;var othis=this;if(othis.editable){othis.syncCellEvent(body)}body.children().each(function(){$(this).bind("click",function(){var tr=$(this);if(othis.editable||(!othis.isSingleSelection&&!othis.isMultipleSelection)){othis.selectedIndex=tr[0]._DT_RowIndex;return true}if(othis.isMultipleSelection){if(!tr.hasClass("selected")){tr.addClass("selected");othis.selectedIndexs.push(tr[0]._DT_RowIndex);othis.selectedIndex=tr[0]._DT_RowIndex;$($(tr).children()[0]).children()[0].checked=true}else{if(tr.hasClass("selected")){othis.selectedIndex=-1;$($(tr).children()[0]).children()[0].checked=false;tr.removeClass("selected");for(var i=0;i<othis.selectedIndexs.length;i++){if(othis.selectedIndexs[i]==tr[0]._DT_RowIndex){othis.selectedIndexs.splice(i,1);break}}}}if(othis.selectedIndexs.length>0){othis.syncButtonGroup(true)}else{othis.syncButtonGroup(false)}$($($(tr).children()[0]).children()[0]).change(function(){if(this.checked){if(!tr.hasClass("selected")){tr.addClass("selected");othis.selectedIndexs.push(tr[0]._DT_RowIndex);othis.selectedIndex=tr[0]._DT_RowIndex}}else{if(tr.hasClass("selected")){othis.selectedIndex=-1;tr.removeClass("selected");for(var i=0;i<othis.selectedIndexs.length;i++){if(othis.selectedIndexs[i]==tr[0]._DT_RowIndex){othis.selectedIndexs.splice(i,1);break}}}}if(othis.selectedIndexs.length>0){othis.syncButtonGroup(true)}else{othis.syncButtonGroup(false)}})}else{var isselected=false;if(tr.hasClass("selected")){var id=othis.id.replace(/\./g,"_");if(IS_MOBILEVIEW){eval($("#"+id+"_openItem")[0].href)}else{$("#"+id+"_openItem").trigger("click")}}else{othis.tbody.find("tr[class*=selected]").removeClass("selected");tr.addClass("selected");othis.selectedIndex=tr[0]._DT_RowIndex;isselected=true}$($(tr).children()[0]).children()[0].checked=true;othis.syncButtonGroup(isselected)}})});if(othis.editable||(selectedByDefault==undefined||!selectedByDefault)||(!othis.isSingleSelection&&!othis.isMultipleSelection)){return}var c=body.children();if(c.length==1){if(this.rowEmpty()){this.syncButtonGroup(false)}else{$(c[0]).addClass("selected");$($(c[0]).children()[0]).children()[0].checked=true;this.selectedIndex=0;this.selectedIndexs.push(0);othis.syncButtonGroup(true)}}else{if(c.length>0){if(this.selectedIndex!=-1){$(c[this.selectedIndex]).addClass("selected")}else{$(c[0]).addClass("selected");$($(c[0]).children()[0]).children()[0].checked=true;this.selectedIndex=0;this.selectedIndexs.push(0)}othis.syncButtonGroup(true)}}},refreshFromServer:function(c){var a=$(elementList[this.id]).find("tbody tr");a.each(function(){$(this).unbind("click")});var d=$(elementList[this.id]).find("tbody td");d.each(function(){$(this).unbind("click")});if(this.appendRowMode){for(var b=0;b<c.length;b++){this.dtable.row.add(c[b]).draw()}}else{this.dtable._fnAjaxUpdateDraw(c)}},refresh:function(a){a=parseInt(a);if(isNaN(a)){a=1}var b=this.dtable.api().settings()[0];b.ajax.data={_ajaxUserEvent:"table",_uiid:this.id,_actionName:"pull",_framePrefix:UIMaster.getFramePrefix(UIMaster.El(this.id).get(0)),_actionPage:this.parentEntity.__entityName,_selectedIndex:this.selectedIndex,_sync:UIMaster.ui.sync()};if(a!=undefined){this.dtable.fnPageChange(a,true)}else{var c=b._iDisplayStart/b._iDisplayLength;this.dtable.fnPageChange(c,true)}},autoRefresh:function(a){if(a.refreshInterval>0){a.sync();a.refresh(0);window.setTimeout(function(){a.autoRefresh(a)},a.refreshInterval*1000)}},importData:function(){},exportData:function(){var a=this.dtable.api().settings()[0];var c="_ajaxUserEvent=table&_uiid="+this.id+"&_actionName=exportTable&_framePrefix="+UIMaster.getFramePrefix(UIMaster.El(this.id).get(0))+"&_actionPage="+this.parentEntity.__entityName;var b=$("<form action="+AJAX_SERVICE_URL+"?r="+Math.random()+"&"+c+" method=post target=_blank></form>");$(b).submit()},statistic:function(){var a={url:AJAX_SERVICE_URL,async:false,success:UIMaster.cmdHandler,data:{_ajaxUserEvent:"table",_uiid:this.id,_actionName:"chart",_framePrefix:UIMaster.getFramePrefix(UIMaster.El(this.id).get(0)),_actionPage:this.parentEntity.__entityName,_selectedIndex:this.selectedIndex,_sync:{}}};if(MobileAppMode){_mobContext.ajax(JSON.stringify(a))}else{$.ajax(a)}}});UIMaster.ui.webtree=function(a){UIMaster.apply(this,a)};UIMaster.ui.webtree=UIMaster.extend(UIMaster.ui,{initialized:false,_selectedNodeId:null,_selectedNodeName:null,_selectedParentNodeId:null,_treeObj:null,init:function(){if(this.initialized){return}this.initialized=true;var t=this;if(!IS_MOBILEVIEW){if($(this).prev().length>0){$($($(this).prev()).children()[0]).buttonset();$($($(this).prev()).children()[0]).removeAttr("style")}}var children=$(this).children();var config=$(children.length==2?children[1]:children[0]);var d=eval("("+config.text()+")");var children=d[0].children;for(var i=0;i<children.length;i++){if(children[i].hasChildren&&children[i].children.length==0){children[i].children=true}}if($(this).children().length==2){this.custItems=$($(this).children()[0]).children()}var clickEvent=config.attr("clickevent");var dblclickEvent=config.attr("dblclickevent");this._addnodeevent=config.attr("addnodeevent");this._addnodeevent0=config.attr("addnodeevent0");this._deletenodeevent=config.attr("deletenodeevent");this._deletenodeevent0=config.attr("deletenodeevent0");this._refreshnodeevent=config.attr("refreshnodeevent");this._refreshnodeevent0=config.attr("refreshnodeevent0");var _treeObj=$(this).jstree({core:{data:d,check_callback:true},plugins:["contextmenu","dnd"],contextmenu:{items:this.createMenu},types:{"#":{max_children:1,max_depth:10,valid_children:[]}}}).bind("loaded.jstree",function(node,tree_obj,e){}).bind("ready.jstree",function(node,tree_obj,e){tree_obj.instance.settings.core.data={url:function(node){return AJAX_SERVICE_URL+"?r="+Math.random()},data:function(node){return{nodeid:node.id,_ajaxUserEvent:"tree",_uiid:t.id,_actionName:"expand",_framePrefix:UIMaster.getFramePrefix(UIMaster.El(t.id).get(0)),_actionPage:t.parentEntity.__entityName,_sync:function(){var ref=$(t).jstree(true);var children=ref.get_children_dom(node);ref.delete_node(children);t.sync();return UIMaster.ui.sync()}}}};$(this).bind("select_node.jstree",function(node,tree_obj,e){var tree=t;if(t._selectedNodeId==tree_obj.node.id){eval(dblclickEvent);return}t._selectedNodeId=tree_obj.node.id;t._selectedNodeName=tree_obj.node.text;t._selectedParentNodeId=tree_obj.node.parent;eval(clickEvent)}).bind("open_node.jstree",function(node,tree_obj,e){t._selectedNodeId=tree_obj.node.id;t._selectedNodeName=tree_obj.node.text;t._selectedParentNodeId=tree_obj.node.parent;var ref=$(t).jstree(true);ref.select_node(tree_obj.node.id)}).bind("create_node.jstree",function(node,tree_obj,position){t._selectedNodeId=tree_obj.node.id;t._selectedNodeName=tree_obj.node.text;t._selectedParentNodeId=tree_obj.node.parent;var ref=$(t).jstree(true);ref.deselect_node(t._selectedParentNodeId);ref.select_node(t._selectedNodeId)}).bind("rename_node.jstree",function(node,tree_obj,old){t._selectedNodeId=tree_obj.node.id;t._selectedNodeName=tree_obj.node.text;t._selectedParentNodeId=tree_obj.node.parent;var tree=t;eval(t._addnodeevent)}).bind("delete_node.jstree",function(node,parent){t._selectedNodeId=parent.node.id;t._selectedNodeName=parent.node.text;t._selectedParentNodeId=parent.node.parent}).bind("move_node.jstree",function(node,parent,position,old_parent,old_position,is_multi,old_instance,new_instance){alert("move_node")})});this._treeObj=$(_treeObj).jstree(true)},createMenu:function(node){var items={};var t=this.element[0];items.refreshItem={label:"Refresh",action:function(e){var ref=$(t).jstree(true);t._sel=ref.get_selected();if(!t._sel.length){return false}ref.refresh_node(t._sel)}};var custItems=this.element[0].custItems;if(custItems!=null){for(var i=0;i<custItems.length;i++){var a=$(custItems[i]);items["item"+i]={label:a.attr("title"),action:function(e){eval(a.attr("event"))}}}}return items},sync:function(){var a=UIMaster.getObject(this);if(this._selectedNodeId&&this._selectedNodeId!=""){UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(a),_valueName:"selectedNode",_value:this._selectedNodeId,_framePrefix:UIMaster.getFramePrefix(a)});UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(a),_valueName:"selectedParentNode",_value:this._selectedParentNodeId,_framePrefix:UIMaster.getFramePrefix(a)});UIMaster.ui.sync.set({_uiid:UIMaster.getUIID(a),_valueName:"selectedNodeName",_value:this._selectedNodeName,_framePrefix:UIMaster.getFramePrefix(a)})}},refresh:function(b){for(var a=0;a<b.length;a++){if(b[a].hasChildren&&b[a].children.length==0){b[a].children=true}}$(this).jstree(true).deselect_all();$(this).jstree({core:{data:b}}).refresh()}});var options=[[["YES_NO_OPTION","YES_OPTION","MESSAGE_DIALOG","Error"],0],[["YES_NO_CANCEL_OPTION","NO_OPTION","INPUT_DIALOG","Information"],1],[["OK_CANCEL_OPTION","OK_OPTION","OPTION_DIALOG","Warning"],2],[["OK_ONLY_OPTION","CANCEL_OPTION","CONFIRM_DIALOG","Question"],3],[["CLOSE_OPTION"],4]];UIMaster.ui.dialog=function(a){a=a||{};UIMaster.apply(this,a);UIMaster.groupAssign(this,options);this.title=this.title||UIMaster.i18nmsg("Common||DIALOG_TITLE");this.message=this.message||UIMaster.i18nmsg("Common||DIALOG_TITLE_MESSAGE");return this};UIMaster.ui.dialog=UIMaster.extend(UIMaster.ui.dialog,{title:null,message:null,optionType:3,options:[],initialValue:0,dialogType:0,messageType:1,isOpen:false,uiid:"",error:false,height:115,width:300,x:-1,y:-1,parent:"",handler:UIMaster.emptyFn,open:function(){if(!this.isOpen){this.paint();this.isOpen=true}},paint:function(){function m(p){j.dialog("close")}function c(p){n.returnValue=new Number(this.getAttribute("returnType"));n.value=$(h).find("td").eq(1).children('[name="returnType"]').val();if(this.getAttribute("id")=="yes"||this.getAttribute("id")=="ok"){var r=n.handler.call(n,p);if(r==false){return}}j.dialog("close")}function o(r,p,s){return $('<input type="button" value="'+r+'" id="'+s+'">').attr("returnType",p).click(this.error?m:c).get(0)}var k=[UIMaster.i18nmsg("Common||DIALOG_TYPE_ERROR"),UIMaster.i18nmsg("Common||DIALOG_TYPE_INFORMATION"),UIMaster.i18nmsg("Common||DIALOG_TYPE_WARNING"),UIMaster.i18nmsg("Common||DIALOG_TYPE_QUESTION")];var f=["Error","Information","Warning","Question"];var n=this;var j=$("<div><div>");var h;if((typeof(this.messageType.length)!="undefined")&&(typeof(this.message.length)!="undefiend")){var a=document.createElement("p");for(var e=0;e<this.messageType.length;e++){$(a).append('<tr><td class="dialog-image"><img width="48px" height="48px" src="'+RESOURCE_CONTEXTPATH+"/images/"+f[this.messageType[e]]+'.png" alt="'+k[this.messageType[e]]+'" title="'+k[this.messageType[e]]+'"></td><td><div>'+this.message[e]+"</div></td></tr>")}h=$($(a).html())}else{h=document.createElement("tr");$(h).append('<td class="dialog-image"><img width="48px" height="48px" src="'+RESOURCE_CONTEXTPATH+"/images/"+f[this.messageType]+'.png" alt="'+k[this.messageType]+'" title="'+k[this.messageType]+'"></td>');var b=document.createElement("td");if(this.error){$(b).append('<pre class="dialog-error-msg">'+this.parent+"</pre>");if(this.message!=UIMaster.i18nmsg("Common||DIALOG_TITLE_MESSAGE")){$('<div id="tracebutton" />').addClass("dialog-trace-button-hide").toggle(function(){$("#trace").show();$("#tracebutton").addClass("dialog-trace-button-show");$("#tracetext").text("Hide Detail");$(j).height(250)},function(){$("#trace").hide();$("#tracebutton").removeClass("dialog-trace-button-show");$("#tracetext").text("Show Detail");$(j).height(100)}).appendTo(b);$(b).append('<div id="tracetext">'+UIMaster.i18nmsg("Common||DIALOG_ERROR_SHOWDETAIL")+"</div>").append('<pre id="trace" style="display:none; padding-left:10px">'+this.message+"</pre>");$(h).append($(b))}}else{$(b).css("text-align","center").append("<div>"+this.message+"</div>").appendTo(h)}}if(this.dialogType==this.INPUT_DIALOG){$(h).find("td").eq(1).append('<input name="returnType" type="text" />')}else{if(this.dialogType==this.OPTION_DIALOG){var q=$('<select name="returnType"></select>');$.each(this.options,function(p,r){$(q).append($("<option></option>").attr("value",p).text(r))});$(h).find("td").eq(1).append(q)}}var d=document.createElement("table");$(d).append("<tbody></tbody>").width("100%").append(h);var l=document.createElement("div");$(l).addClass("dialog-option");if(this.optionType==this.YES_NO_OPTION||this.optionType==this.YES_NO_CANCEL_OPTION){$(l).append(o.call(this,UIMaster.i18nmsg("Common||DIALOG_BTN_YES"),this.YES_OPTION,"yes")).append(o.call(this,UIMaster.i18nmsg("Common||DIALOG_BTN_NO"),this.NO_OPTION,"no"))}else{if(this.optionType==this.CLOSE_OPTION){l.appendChild(o.call(this,UIMaster.i18nmsg("Common||DIALOG_BTN_CLOSE"),this.CLOSE_OPTION,"close"))}else{l.appendChild(o.call(this,UIMaster.i18nmsg("Common||DIALOG_BTN_OK"),this.OK_OPTION,"ok"))}}if(this.optionType==this.YES_NO_CANCEL_OPTION||this.optionType==this.OK_CANCEL_OPTION){l.appendChild(o.call(this,UIMaster.i18nmsg("Common||DIALOG_BTN_CANCEL"),this.CANCEL_OPTION,"cancel"))}$(l).find(":button").css("margin-left","50px").eq(0).css("margin-left","10px");j.append(d).append(l);j.dialog({title:this.title,width:this.width,height:this.height,modal:true})}});UIMaster.groupAssign(UIMaster.ui.dialog,options);UIMaster.ui.mask={init:function(){if(typeof this._count=="undefined"){this._count=1}else{this._count=this._count+1}if(this._count==1){var a=document.createElement("div");a.id="ui-mask-shadow";a.className="ui-overlay";a.innerHTML='<div class="ui-widget-overlay"></div><div id="uimaster_mask_content" class="outer"><div class="inner"><p></p></div></div>';a.style.display="none";document.body.insertBefore(a,document.body.firstChild)}},open:function(a){if(this._isOpen){return}$("#ui-mask-shadow").show();this._isOpen=true},close:function(a,b){this._count=this._count?this._count-1:0;if(this._count!=0||!this._isOpen){return}if(typeof a==="undefined"){$("#ui-mask-shadow").delay(1000).hide();$("#ui-mask-content").delay(1000).hide()}else{if(typeof a==="boolean"){if(a===false){$("#ui-mask-content").html('<div class="inner"><p class="ui-fail-msg"><span></span>'+(b==undefined?"Error Found.":b)+"</p></div>").addClass("ui-info-fail-border");$("#ui-mask-content").fadeOut(1500);$("#ui-mask-shadow").delay(1000).fadeOut(200)}else{if(a===true){$("#ui-mask-content").html('<div class="inner"><p class="ui-suc-msg"><span></span>'+(b==undefined?"Operation Successful.":b)+"</p></div>").addClass("ui-info-suc-border");$("#ui-mask-content").fadeOut(1500);$("#ui-mask-shadow").delay(1000).fadeOut(200)}}}}this._isOpen=false},openA:function(a){this.open()},updateA:function(a){this.close(false,a)}};UIMaster.ui.window=UIMaster.extend(UIMaster.ui.dialog,{hidePFrame:false,open:function(){if(!this.isOpen){var w=this.width==0?500:this.width;var h=this.height==0?300:this.height;var thisObj=this;this.content=$("<div><div>").html(this.data).attr("id",this.id).css("-webkit-transform","translateZ(0)");var buttonset=[];if(this.isOnlyShowCloseBtn=="true"){buttonset=[{text:"\u5173\u95ED",click:function(){thisObj.content.dialog("close")}}]}else{var p=this.content.find("div[id$='actionPanel']");if(p.length>0){$(p[p.length-1]).css("display","none");var buttons=$(p[p.length-1]).find("input[type='button']");var count=0;for(var i=0;i<buttons.length;i++){var b=buttons[i];if($(b).attr("disabled")==null||$(b).attr("disabled")=="false"){buttonset[count++]={text:b.value,open:function(){if(IS_MOBILEVIEW){$(this).addClass("uimaster_button")}},click:function(e){var text=$(e.srcElement?e.srcElement:e.target).text();for(var i=0;i<buttons.length;i++){if(text==buttons[i].value){$(buttons[i]).click();break}}}}}if(IS_MOBILEVIEW){$(b).button()}}}}this.content.dialog({title:thisObj.title,height:IS_MOBILEVIEW?($(window.top).height()-50):h,width:IS_MOBILEVIEW?"100%":w,modal:true,closeOnEscape:true,show:{effect:IS_MOBILEVIEW?"slide":"blind",duration:500},hide:{effect:IS_MOBILEVIEW?"slide":"blind",duration:500},open:function(){if(IS_MOBILEVIEW){$(this).parent().parent().appendTo($("form:first"))}},beforeClose:function(){},buttons:buttonset});$($("#"+this.id).children().get(0)).attr("_framePrefix",this.frameInfo);if(this.js){getElementListSingle(this.content,true);eval(this.js);defaultname.addComponent(eval(D+this.uiid),true)}UIMaster.ui.window.addWindow(this.id,this);if(IS_MOBILEVIEW){$(this.content).enhanceWithin()}this.isOpen=true;var p=this.content.find("div[id$='actionPanel']");if(p.length>0){var dbuttons=$($(this.content.parent()).find("div[class*='ui-dialog-buttonpane']")[0]).find("button[type='button']");var buttons=$(p[0]).find("input[type='button']");var count=0;for(var i=0;i<buttons.length;i++){var b=buttons[i];if($(b).attr("disabled")!=null&&$(b).attr("disabled")=="true"){continue}var btnClass=$(b).attr("class");if(!$(dbuttons[count]).hasClass(btnClass)){$(dbuttons[count]).addClass(btnClass);$(dbuttons[count]).removeClass("uimaster_button")}count++}}}},close:function(){if(event){event.preventDefault()}if(elementList[this.uiid+".Form"]){elementList[this.uiid+".Form"].parentEntity.releaseFormObject()}this.content.dialog("close");this.content.parent().remove();defaultname.removeComponent(eval(D+this.uiid));UIMaster.ui.window.removeWindow(this.id,this)}});UIMaster.apply(UIMaster.ui.window,{wList:[],addWindow:function(b,a){this.wList[b]=a},removeWindow:function(a){delete this.wList[a]},getWindow:function(a){return this.wList[a]}});function iframeAutoFitHeight(b,a){a.height=$("#"+b).height()+"px"}function showMobileFrame(e,a){if(e=="#"){return}var c=e.substring(e.indexOf("_framename=")+"_framename=".length);c=c.substring(0,c.indexOf("&"));var b=$('<iframe id="'+c+'" name="'+c+'" src="about:blank" needsrc="true" frameborder="0" style="min-width:100%;min-height:100%;-webkit-transform: translateZ(0);"></iframe>');var f=$('<div><div style="position: absolute;top:150px;left:100px;"><img style="width:150px" src="/uimaster/images/qd-logo.png"></div></div>');f.append(b);f.dialog({id:"mobileOnlyOneFrame",autoOpen:false,title:a,height:$(window).height(),width:"99.5%",modal:true,resizable:false,draggable:false,show:{effect:"slide",duration:150},hide:{effect:"slide",duration:500},open:function(d,h){window.setTimeout(function(){b.attr("src",e)},200);window.setTimeout(function(){$(f.children()[0]).css("display","none")},8000)},beforeClose:function(){b.attr("src","about:blank")},close:function(){$.ajax({url:AJAX_SERVICE_URL,async:true,data:{_ajaxUserEvent:"tabpane",_uiid:"Form",_valueName:"remveTabId",_value:c,_framePrefix:UIMaster.getFramePrefix()}})}});f.dialog("open")}UIMaster.ui.tab=UIMaster.extend(UIMaster.ui,{links:[],index:0,selectedIndex:0,subComponents:null,isInitialized:false,init:function(){if(this.isInitialized){return}this.isInitialized=true;var e=this,d=this.childNodes[0].nodeType==1?this.childNodes[0]:this.childNodes[1],f=d.childNodes[0].nodeType==1?d.childNodes[0]:d.childNodes[1];for(var c in f.childNodes){if(f.childNodes[c].nodeType==1){$(f.childNodes[c]).hover(function(){var j=$(this).parent().children();for(var h=0;h<j.length;h++){$(j[h]).removeClass("ui-state-hover")}$(this).addClass("ui-state-hover")}).click(function(){e.setTab(this)})}}var b=$("#bodies-container-"+this.id).children();b.each(function(){if(typeof($(this).attr("uipanelid"))!="undefined"){$(this).append($(elementList[$(this).attr("uipanelid")]).parent())}});if(this.subComponents!=null){for(var c=0;c<this.subComponents.length;c++){var a=elementList[this.subComponents[c]];a&&(a.parentEntity=this.parentEntity)!=null&&a.init&&a.init()}}},sync:function(){if(this.subComponents!=null&&this.subComponents[this.selectedIndex]&&defaultname[this.subComponents[this.selectedIndex]]&&defaultname[this.subComponents[this.selectedIndex]].sync){defaultname[this.subComponents[this.selectedIndex]].sync()}},setTab:function(a){var b=UIMaster.getObject(a).getAttribute("id");this._setTab(b)},_setTab:function(c){var e=$("#"+c),a=e.parent(),h=a.children(),b=a.next().children();for(var d=0;d<h.length;d++){$(h[d]).removeClass("ui-tabs-active").removeClass("ui-state-active").attr("style",null)}for(var d=0;d<b.length;d++){$(b[d]).removeClass("tab-selected-body").addClass("tab-unselected-body")}e.addClass("ui-tabs-active").addClass("ui-state-active").attr("style","border-bottom: 1px solid white;");$("#"+e.attr("id").replace("titles","body")).removeClass("tab-unselected-body").addClass("tab-selected-body");a.attr("selectedIndex",e.attr("index"));this.selectedIndex=e.attr("index");if(e.attr("ajaxload")!=null&&e.attr("ajaxload")=="true"){e.attr("ajaxload",null)}var f={url:AJAX_SERVICE_URL,async:false,success:UIMaster.cmdHandler,data:{_ajaxUserEvent:"tabpane",_uiid:this.id,_valueName:"selectedIndex",_value:e.attr("index"),_framePrefix:UIMaster.getFramePrefix()}};if(MobileAppMode){_mobContext.ajax(JSON.stringify(f))}else{$.ajax(f)}},addFrameTab:function(c,a){if(this.links.length==0){this.addTab(a,c,this.index++,true)}else{for(var b=0;b<this.links.length;b++){if(this.links[b].src==a){this._setTab(this.links[b].tabId);return}}this.addTab(a,c,this.index++,true)}},addTab:function(h,p,n,r){var k=$("#titles-container-"+this.id).children(),b=$("#bodies-container-"+this.id).children(),d=k.length;if(n===undefined||n==""){n=this.index++}var e="tab-"+this.id+"-titles-"+n,a=e.replace("titles","body"),m=$('<div id="'+e+'" class ="ui-state-default ui-corner-top" index="'+n+'"><span style="float:left;">'+p+'&nbsp;&nbsp;</span><span class="ui-icon ui-icon-circle-close" i="'+n+'"></span></div>');this.links.push({src:h,tabId:e,i:n});var j;if(r!=undefined){var o=h.substring(h.indexOf("_framename=")+"_framename=".length);o=o.substring(0,o.indexOf("&"));j=$('<div id="'+a+'" class="tab-unselected-body" index="'+n+'"><iframe id="'+o+'" name="'+o+'" src="'+h+'" needsrc="true" frameborder="0" style="min-width:100%;min-height:100%;"></iframe></div>');var q=this,l=j.children()[0]}else{j=$('<div id="'+a+'" class="tab-unselected-body" index="'+n+'">'+h+"</div>")}m.appendTo($("#titles-container-"+this.id));j.appendTo($("#bodies-container-"+this.id));var c=this;m.click(function(){if(!$(this).attr("removed")){c.setTab(this)}});m.children(".ui-icon-circle-close").click(function(){c.removeTab(-1,$(this).attr("i"))});this._setTab(e)},addTabByLazyLoading:function(c,b){var d=null;var a=$("#bodies-container-"+this.id).children();a.each(function(){if($(this).attr("uiid")==b){$(c).appendTo($(this));d=$(this);if(IS_MOBILEVIEW){$(this).trigger("create")}return false}});return d},removeTab:function(h,l){var b=this;var f=$("#titles-container-"+this.id).children(),a=$("#bodies-container-"+this.id).children();if(l){f.each(function(c,n){if($(n).attr("index")==l){h=c;return false}})}if(h<0||f.length<=h){return}var k=f[h];$(k).attr("removed","true");$(k).fadeOut(500,function(){$(k).remove();f=$("#titles-container-"+b.id).children();if(f.length!=0){b._setTab($(f[f.length-1]).attr("id"))}});var m=a[h];var j=$(m).children();if(j.length>0&&j[0].tagName.toLowerCase()=="iframe"){var e=b.ui;$.ajax({url:AJAX_SERVICE_URL,async:true,data:{_ajaxUserEvent:"tabpane",_uiid:b.id,_valueName:"remveTabId",_value:$(j[0]).attr("name"),_framePrefix:UIMaster.getFramePrefix()}})}$(m).remove();for(var d=0;d<b.links.length;d++){if(b.links[d].i==l){b.links.remove(d);break}}},setTabAt:function(c,b){var a=$("#bodies-container-"+this.id).children();if(b===undefined||b>=a.length||b<0){return}a.slice(b,b+1).html(c)},setTitleAt:function(c,a){var b=$("#titles-container-"+this.id).children();if(a===undefined||a>=b.length||a<0){return}b.slice(a,a+1).html(c)},setSelectedTab:function(a){var b=$("#titles-container-"+this.id).children();if(a===undefined||a>=b.length||a<0){return}this._setTab(b[a].getAttribute("id"))},getTabLength:function(){return $("#titles-container-"+this.id).children().length}});UIMaster.ui.prenextpanel=UIMaster.extend(UIMaster.ui,{links:[],index:0,selectedIndex:0,subComponents:null,isInitialized:false,titleContainer:null,bodyContainer:null,init:function(){if(this.isInitialized){return}this.isInitialized=true;var f=this,d=this.childNodes[0].nodeType==1?this.childNodes[0]:this.childNodes[1],h=d.childNodes[0].nodeType==1?d.childNodes[0]:d.childNodes[1];this.titleContainer=$($(d).children()[0]);this.bodyContainer=$($(d).children()[1]);var b=this.bodyContainer.children();b.each(function(){if(typeof($(this).attr("uipanelid"))!="undefined"){$(this).append($(elementList[$(this).attr("uipanelid")]).parent())}});var e=$($(d).children()[2]).children();$(e[0]).button().click(function(){if(!f.validate0()){return}if(!f.setTab("prev")){return}UIMaster.ui.sync.set({_uiid:f.id,_valueName:"selectedIndex",_value:f.selectedIndex,_framePrefix:UIMaster.getFramePrefix(this)});$.ajax({url:AJAX_SERVICE_URL,async:false,success:UIMaster.cmdHandler,data:{_ajaxUserEvent:"prenextpanel",_uiid:f.id,_valueName:"prevbtn",_framePrefix:UIMaster.getFramePrefix(),_sync:UIMaster.ui.sync()}})});$(e[1]).button().click(function(){if(!f.validate0()){return}if(!f.setTab("next")){return}UIMaster.ui.sync.set({_uiid:f.id,_valueName:"selectedIndex",_value:f.selectedIndex,_framePrefix:UIMaster.getFramePrefix(this)});$.ajax({url:AJAX_SERVICE_URL,async:false,success:UIMaster.cmdHandler,data:{_ajaxUserEvent:"prenextpanel",_uiid:f.id,_valueName:"nextbtn",_framePrefix:UIMaster.getFramePrefix(),_sync:UIMaster.ui.sync()}})});if(this.subComponents!=null){for(var c=0;c<this.subComponents.length;c++){var a=elementList[this.subComponents[c]];a&&(a.parentEntity=this.parentEntity)!=null&&a.init&&a.init()}}},validate0:function(){if(this.subComponents!=null&&this.subComponents[this.selectedIndex]){var id="defaultname."+this.subComponents[this.selectedIndex];var constraint_result=eval(id).validate();if(constraint_result!=true&&constraint_result!=null){return false}}return true},sync:function(){if(this.subComponents!=null&&this.subComponents[this.selectedIndex]){var id="defaultname."+this.subComponents[this.selectedIndex];eval(id)!=null&&eval(id).sync!=null&&eval(id).sync()}},setTab:function(b){var d=null;var c=this.titleContainer.children();if(b=="prev"){if(this.selectedIndex==0){return false}for(var a=0;a<c.length;a++){if(a==this.selectedIndex){var d=c[a-1].getAttribute("id");this._setTab(d);return true}}}else{if((this.selectedIndex+1)==c.length){return false}for(var a=0;a<c.length;a++){if(a==this.selectedIndex){var d=c[a+1].getAttribute("id");this._setTab(d);return true}}}return false},_setTab:function(c){var e=$("#"+c),a=e.parent(),f=a.children(),b=a.next().children();for(var d=0;d<f.length;d++){$(f[d]).removeClass("ui-tabs-active").removeClass("ui-state-active").attr("style",null)}for(var d=0;d<b.length;d++){$(b[d]).removeClass("tab-selected-body").addClass("tab-unselected-body")}e.addClass("ui-tabs-active").addClass("ui-state-active").attr("style","border-bottom: 1px solid white");$("#"+e.attr("id").replace("titles","body")).removeClass("tab-unselected-body").addClass("tab-selected-body");a.attr("selectedIndex",e.attr("index"));this.selectedIndex=parseInt(e.attr("index"));if(e.attr("ajaxload")!=null&&e.attr("ajaxload")=="true"){e.attr("ajaxload",null)}$.ajax({url:AJAX_SERVICE_URL,async:false,success:UIMaster.cmdHandler,data:{_ajaxUserEvent:"prenextpanel",_uiid:this.id,_valueName:"selectedIndex",_value:e.attr("index"),_framePrefix:UIMaster.getFramePrefix()}})},setTabAt:function(c,b){var a=$("#bodies-container-"+this.id).children();if(b===undefined||b>=a.length||b<0){return}a.slice(b,b+1).html(c)},setTitleAt:function(c,a){var b=$("#titles-container-"+this.id).children();if(a===undefined||a>=b.length||a<0){return}b.slice(a,a+1).html(c)},setSelectedTab:function(a){var b=$("#titles-container-"+this.id).children();if(a===undefined||a>=b.length||a<0){return}this._setTab(b[a].getAttribute("id"))},getTabLength:function(){return $("#titles-container-"+this.id).children().length}});UIMaster.ui.chart=UIMaster.extend(UIMaster.ui,{type:null,chart:null,init:function(){var obj=eval("("+$(this).text()+")");this.type=obj.type;var ctx=$(this).get(0).getContext("2d");if(this.type=="HTMLChartBarType"){obj.type="bar";this.chart=new Chart(ctx,obj)}else{if(this.type=="HTMLChartDoughnutType"){obj.type="doughnut";this.chart=new Chart.Doughnut(ctx,obj.obj)}else{if(this.type=="HTMLChartLinearType"){obj.type="line";this.chart=new Chart(ctx,obj)}else{if(this.type=="HTMLChartPieType"){obj.type="pie";this.chart=new Chart(ctx,obj)}else{if(this.type=="HTMLChartPolarPieType"){this.chart=new Chart.PolarArea(ctx,obj.data)}else{if(this.type=="HTMLChartRadarType"){obj.type="radar";this.chart=new Chart(ctx,obj)}}}}}}}});UIMaster.ui.matrix=UIMaster.extend(UIMaster.ui,{type:null,isInitialized:false,init:function(){if(this.isInitialized){return}this.isInitialized=true;var b=this;var a=$(this).find("span[class='uimaster_matrix_col']");a.each(function(){$(this).hover(function(){}).click(function(){a.each(function(){$(this).removeClass("ui-state-hover")});$(this).addClass("ui-state-hover");UIMaster.ui.sync.set({_uiid:b.id,_valueName:"selectedNode",_value:$(this).text(),_framePrefix:UIMaster.getFramePrefix(b)});UIMaster.ui.sync.set({_uiid:b.id,_valueName:"selectedX",_value:$($(this).parent()).attr("j"),_framePrefix:UIMaster.getFramePrefix(b)});UIMaster.ui.sync.set({_uiid:b.id,_valueName:"selectedY",_value:$($(this).parent().parent()).attr("i"),_framePrefix:UIMaster.getFramePrefix(b)})})})}});UIMaster.ui.map=UIMaster.extend(UIMaster.ui,{map:null,init:function(){this.map=new BMap.Map(this.id);this.map.enableScrollWheelZoom();this.map.enableContinuousZoom();this.map.addControl(new BMap.NavigationControl());this.map.addControl(new BMap.OverviewMapControl());this.map.addControl(new BMap.OverviewMapControl({isOpen:true,anchor:BMAP_ANCHOR_BOTTOM_RIGHT}))},search:function(a){var b=new BMap.LocalSearch(this.map,{renderOptions:{map:this.map,panel:$(this).next().attr("id")},pageCapacity:5});b.enableAutoViewport();b.setSearchCompleteCallback(function(c){});b.searchInBounds(a,this.map.getBounds())}});UIMaster.ui.chat=UIMaster.extend(UIMaster.ui,{partyId:0,init:function(){}});